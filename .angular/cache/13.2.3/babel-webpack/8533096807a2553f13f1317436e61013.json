{"ast":null,"code":"import { Meals, MealsRequests, Restaurants } from 'src/app/shared/NewClasses';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/new-services/restaurants.service\";\nimport * as i2 from \"src/app/new-services/meals-requests.service\";\nimport * as i3 from \"src/app/new-services/meals.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"src/app/new-services/user-login.service\";\nimport * as i6 from \"src/app/new-services/profiles.service\";\n\nfunction MealRequestComponent_form_3_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.restaurant.RestaurantName, \" Restaurant\");\n  }\n}\n\nfunction MealRequestComponent_form_3_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Invitation by \", ctx_r2.invitation.InitiatorName, \"\");\n  }\n}\n\nfunction MealRequestComponent_form_3_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵelementStart(8, \"input\", 9, 10);\n    i0.ɵɵlistener(\"[ngModel]\", function MealRequestComponent_form_3_tr_16_Template_input__ngModel__8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const meal_r5 = restoredCtx.$implicit;\n      return meal_r5.Count;\n    })(\"change\", function MealRequestComponent_form_3_tr_16_Template_input_change_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const meal_r5 = restoredCtx.$implicit;\n\n      const _r6 = i0.ɵɵreference(9);\n\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.selectt(_r6.value, meal_r5);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const meal_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(meal_r5.MealName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(meal_r5.Description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(meal_r5.Price);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(meal_r5.Price * meal_r5.Count);\n  }\n}\n\nfunction MealRequestComponent_form_3_span_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.mealRequest.TotalPrice);\n  }\n}\n\nfunction MealRequestComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 3);\n    i0.ɵɵlistener(\"ngSubmit\", function MealRequestComponent_form_3_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.SaveMealRequest(ctx_r10.mealRequest);\n    });\n    i0.ɵɵtemplate(1, MealRequestComponent_form_3_p_1_Template, 2, 1, \"p\", 4);\n    i0.ɵɵtemplate(2, MealRequestComponent_form_3_p_2_Template, 2, 1, \"p\", 4);\n    i0.ɵɵelementStart(3, \"table\", 5);\n    i0.ɵɵelementStart(4, \"thead\");\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Meal Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Meal Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Meal Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Meal Count\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Sub Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"tbody\");\n    i0.ɵɵtemplate(16, MealRequestComponent_form_3_tr_16_Template, 12, 4, \"tr\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(17, \"br\");\n    i0.ɵɵtemplate(18, MealRequestComponent_form_3_span_18_Template, 2, 1, \"span\", 4);\n    i0.ɵɵelementStart(19, \"button\", 7);\n    i0.ɵɵelement(20, \"i\", 8);\n    i0.ɵɵtext(21, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.restaurant);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.invitation);\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.restaurant.Meals);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.mealRequest.TotalPrice);\n  }\n}\n\nexport let MealRequestComponent = /*#__PURE__*/(() => {\n  class MealRequestComponent {\n    constructor(restaurentService, mealsRequestsService, mealService, activateRoute, userLoginService, profilesSRV) {\n      this.restaurentService = restaurentService;\n      this.mealsRequestsService = mealsRequestsService;\n      this.mealService = mealService;\n      this.activateRoute = activateRoute;\n      this.userLoginService = userLoginService;\n      this.profilesSRV = profilesSRV;\n      this.myRest = [];\n      this.myPersons = [];\n      this.restaurant = new Restaurants();\n      this.mealRequest = new MealsRequests();\n      this.selectedMeal = new Meals();\n    }\n\n    ngOnInit() {\n      this.activateRoute.paramMap.subscribe(params => {\n        console.log(\"invitation : \", params);\n        this.invitation = params;\n        this.restaurentService.getRestaurants().subscribe(restaurantResult => {\n          console.log(restaurantResult);\n          this.myRest = restaurantResult;\n          this.myRest.forEach(elem => {\n            if (elem.RestaurantName === this.invitation.params.RestaurantName) {\n              this.restaurant = elem;\n            }\n          });\n        });\n      });\n      this.profilesSRV.getProfiles().subscribe(data => {\n        this.myPersons = data;\n      });\n    }\n\n    selectt(soso, meal) {\n      let count = Number(soso);\n      console.log(\"count : \", count);\n      this.selectedMeal = meal;\n      meal.Count = count;\n      console.log(\"meal  : \", meal);\n      console.log(\"selecteddd meal :   \", this.selectedMeal);\n\n      if (count > 0) {\n        if (!this.mealRequest.Meal.includes(this.selectedMeal)) {\n          this.selectedMeal.Count = count;\n          console.log(\"push\", this.selectedMeal.MealName);\n          this.mealRequest.Meal.push(this.selectedMeal);\n          this.mealRequest.TotalPrice = this.mealRequest.TotalPrice + this.selectedMeal.Price * count;\n        } else {\n          if (this.mealRequest.Meal.includes(this.selectedMeal)) {\n            if (this.mealRequest.Count > count) {\n              console.log(\"count not equal\");\n              this.mealRequest.TotalPrice = this.mealRequest.TotalPrice - this.selectedMeal.Price * (count - 1);\n            } else {\n              this.mealRequest.TotalPrice = this.mealRequest.TotalPrice + this.selectedMeal.Price * (count - 1);\n            }\n          }\n        }\n      } else {\n        this.mealRequest.TotalPrice = this.mealRequest.TotalPrice - this.selectedMeal.Price * count;\n      }\n    }\n\n    SaveMealRequest(mealRequestt) {\n      console.log(\"meal requestt \", mealRequestt);\n      let userMail = this.userLoginService.returnedUser.user.email;\n      this.myPersons.forEach(elem => {\n        if (elem.Email === userMail) {\n          mealRequestt.PersonName = elem.FirstName + elem.LastName;\n        }\n      });\n      this.mealsRequestsService.saveMealsRequest(mealRequestt).subscribe(result => {\n        console.log(\"result save meal request:  \", result);\n      });\n    }\n\n  }\n\n  MealRequestComponent.ɵfac = function MealRequestComponent_Factory(t) {\n    return new (t || MealRequestComponent)(i0.ɵɵdirectiveInject(i1.RestaurantsService), i0.ɵɵdirectiveInject(i2.MealsRequestsService), i0.ɵɵdirectiveInject(i3.MealsService), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i5.UserLoginService), i0.ɵɵdirectiveInject(i6.ProfilesService));\n  };\n\n  MealRequestComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MealRequestComponent,\n    selectors: [[\"app-meal-request\"]],\n    decls: 4,\n    vars: 1,\n    consts: [[1, \"my-5\", \"py-5\", \"container\", \"text-center\", \"stylish-color-dark\", \"font-weight-bold\", \"text-white\", \"color-block\"], [1, \"h4\", \"mb-4\", 2, \"font-weight\", \"bold\"], [3, \"ngSubmit\", 4, \"ngIf\"], [3, \"ngSubmit\"], [4, \"ngIf\"], [1, \"table\", 2, \"background-color\", \"gray\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-elegant\"], [\"aria-hidden\", \"true\", 1, \"far\", \"fa-kiss-wink-heart\", \"fa-lg\", \"pr-2\"], [\"min\", \"0\", \"type\", \"number\", 3, \"[ngModel]\", \"change\"], [\"count\", \"\"]],\n    template: function MealRequestComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"p\", 1);\n        i0.ɵɵtext(2, \"Meal Request\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, MealRequestComponent_form_3_Template, 22, 4, \"form\", 2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.restaurant.Meals);\n      }\n    },\n    styles: [\"\"]\n  });\n  return MealRequestComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}